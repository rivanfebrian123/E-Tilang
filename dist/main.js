var a=new XMLHttpRequest();a.open("GET",'data.xlsx',true);a.responseType='arraybuffer';a.setRequestHeader('Cache-Control','no-cache, no-store, max-age=0');a.setRequestHeader('Expires','Tue, 01 Jan 1980 1:00:00 GMT');a.setRequestHeader('Pragma','no-cache');var b=null;var c=null;var d=0;var e=0;var f=null;var g=null;var h="";var i=null;var j=null;var k="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";var l=['iPhone','iPad','iPod'].indexOf(navigator.platform)!=-1||(navigator.userAgent.indexOf('Mac')!=-1&&'ontouched' in document);var m=null;var n=null;var o=null;var p=null;var q=null;var r=null;var s=$(document.body);var t=$(window);function u(a,b){if(!a.hasClass(b))a.addClass(b).one(k,function(){a.removeClass(b);});}function v(a){var b=a.toString().split('.');b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,'.');return b.join(',');}function w(a){return a.replace(/\s+/g,'').toLowerCase();}function x(a){return a.toLowerCase().split(' ').map(function(a){return a[0].toUpperCase()+a.slice(1);}).join(' ');}function y(a){if(a.is(":focus"))a.attr("readonly","readonly").attr("disabled","true").blur().removeAttr("readonly").removeAttr("disabled");}function z(a){return '<span><img src="dist/'+a+'"/></span>';}function A(a,b,c,d,e,f){var g=b.replace(/spm/gi,"Sepeda Motor").replace(/l.truck/gi,"Light Truck")+' | '+c;f=f.replace(/ran/gi,"Kendaraan").replace(/tnp/gi,"Tanpa").replace(/plat/gi,"Plat");var h=$('<div class="hasil flex baris"></div');var j=$('<div class="atas flex kolom"></div>');var k=$('<div class="bawah flex kolom"></div>');j.append('<h3 class="elipsis">'+a+'</h3>');j.append('<h4 class="elipsis">'+g+'</h4>');k.append('<div class="id elipsis">'+z('id.svg')+g+'</div>');k.append('<div>'+z('uang.svg')+v(d)+'</div>');k.append('<div class="elipsis">'+z('palu.svg')+e+'</div>');k.append('<div class="elipsis">'+z('dompet.svg')+f+'</div>');h.append(j).append(k);h.click(function(){i=$(this).hasClass("pilih");u($(this).children().eq(1),"fadein");$(".pilih").removeClass("pilih");if(!i)$(this).addClass("pilih");});return h;}function B(){var a=o.val();if(h===a)return null;var b=w(a);u(m,"fadein");$(".hasil").each(function(){var a=$(this).children().eq(0).children();var c=w(a.eq(0).text());var d=a.eq(1).text().split('|');var e=w(typeof d[1]=='undefined'?d[0]:d[1]);if(c.indexOf(b)!=-1||e.indexOf(b)!=-1)$(this).show();else $(this).hide();});h=o.val();}function C(){f=q.offset().top-(o.height()/2.5);g=m.offset().top-(o.height()*1.7);console.log(g);}function D(){d=t.scrollTop();if(d==e)return null;if(d>f){p.addClass("ambang");q.addClass("pad");}else{p.removeClass("ambang");q.removeClass("pad");}if(d>g)if(d>e)p.addClass("sembunyi");else if(d<e)p.removeClass("sembunyi");if(j)y(o);e=d;}a.onload=function(){var c=XLSX.read(a.response,{type:'array'});var d=[];c.SheetNames.forEach(function(a){XLSX.utils.sheet_to_json(c.Sheets[a],{header:1}).forEach(function(a){d.push(a);});});r.text("Sidang: "+x(d[2][3].replace("SIDANG PADA TANGGAL ","")));d.forEach(function(a){if(typeof a[0]==='number'&&typeof a[2]==='string')m.append(A(a[2],a[4],a[1],a[7]+a[8],a[5],a[6]));});n.submit(function(a){a.preventDefault();y(o);});n.keyup(function(a){a.preventDefault();clearTimeout(b);b=setTimeout(B,225);});n.removeClass("load");$(".load").remove();o.focus();};a.onerror=function E(){location.reload();};$(function(){m=$("#daftar");n=$("#cari");o=$("#kunci");p=$("#navigasi");q=$("#navigasi-pad");r=$("#sidang");t.resize(function(){C();D();});t.scroll(D);t.on("touchmove",function(){j=true;clearTimeout(c);c=setTimeout(function(){j=false;},100);});if(l)$("input").focus(function(){s.scrollTop(0);});C();D();a.send();});